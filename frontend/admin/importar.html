
<!doctype html><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Importar listas</title>
<style>body{font:15px system-ui;background:#f5f7f6;color:#0e2720;margin:0;display:grid;place-items:center;min-height:100vh}
.card{width:min(660px,94vw);background:#fff;border:1px solid #e6efea;border-radius:16px;box-shadow:0 18px 50px rgba(6,68,39,.12);padding:20px}
label{font-weight:700;display:block;margin:10px 0 6px}
input[type=file]{width:100%;padding:10px;border:1px solid #cfe2da;border-radius:10px}
.btn{margin-top:12px;border:0;background:#064427;color:#fff;border-radius:10px;padding:10px 12px;font-weight:700;cursor:pointer}
.note{color:#5c6e68}
</style>
<div class="card">
  <h2>Importar listas desde reporte</h2>
  <p class="note">Acepta <b>CSV</b> con columnas <code>cirujano,especialidad,obra_social</code> o el <b>XLS-HTML</b> que exporta Excel.</p>
  <label>Archivo</label><input id="file" type="file" />
  <button class="btn" id="btnCsv">Importar CSV</button>
  <button class="btn" id="btnXls">Importar XLS-HTML</button>
  <div id="out" class="note" style="margin-top:10px"></div>
  <div style="margin-top:10px"><a class="btn" href="/menu.html">Ir al Menú</a></div>
</div>
<script>
async function send(url){
  const f=document.getElementById('file').files[0]; if(!f){ alert('Seleccioná un archivo'); return; }
  const fd=new FormData(); fd.append('file', f);
  const r=await fetch(url,{method:'POST',body:fd}); const d=await r.json();
  document.getElementById('out').textContent = JSON.stringify(d);
}
document.getElementById('btnCsv').onclick=()=>send('/api/ref/import/csv');
document.getElementById('btnXls').onclick=()=>send('/api/ref/import/xls-html');
</script>
